diff --git a/CHANGELOG.md b/CHANGELOG.md
index c71cde0..fe8e470 100644
--- a/CHANGELOG.md
+++ b/CHANGELOG.md
@@ -104,3 +104,12 @@ All notable changes to this GitHub release are documented here.
   **Files:** `register.php`, `oauth/github_callback.php`, `oauth/facebook_callback.php`, `oauth/facebook/callback/facebook_callback.php`
 
 
+
+## 2026-01-17 Display Name Validation Patch (v1.11-git-clean-r14)
+
+### Display name / اسم الظهور
+- Fixed: display name validation could reject valid Arabic names due to invisible characters, smart apostrophes, or diacritics.
+  - Added Unicode-safe normalization (`normalize_display_name`) that removes zero-width characters, normalizes apostrophes, strips combining marks, and collapses whitespace.
+  - Enforced the exact allowed character set: letters/numbers/spaces and `. _ - '`.
+  - OAuth: sanitize provider display names to the allowed character set to avoid validation failures.
+  **Files:** `includes/bootstrap.php`, `profile.php`, `register.php`, `oauth/github_callback.php`, `oauth/facebook_callback.php`, `oauth/facebook/callback/facebook_callback.php`
diff --git a/includes/bootstrap.php b/includes/bootstrap.php
index 04605fb..2229300 100644
--- a/includes/bootstrap.php
+++ b/includes/bootstrap.php
@@ -48,6 +48,56 @@ require_once ROOT_PATH . '/includes/env.php';
 // DB helpers (PDO source of truth)
 require_once ROOT_PATH . '/includes/db.php';
 
+
+if (!function_exists('normalize_display_name')) {
+    /**
+     * Normalize display name input (Unicode-safe):
+     * - remove zero-width characters
+     * - normalize apostrophes
+     * - strip diacritics/marks (tashkeel)
+     * - collapse whitespace
+     */
+    function normalize_display_name(string $name): string {
+        // Remove zero-width characters (ZWSP, ZWNJ, ZWJ, BOM)
+        $name = preg_replace('/[\x{200B}-\x{200D}\x{FEFF}]/u', '', $name) ?? $name;
+        // Normalize smart apostrophes to plain apostrophe
+        $name = str_replace(["’", "‘", "´"], "'", $name);
+        // Strip combining marks (helps avoid false rejections)
+        $name = preg_replace('/[\p{M}]+/u', '', $name) ?? $name;
+        $name = trim($name);
+        $name = preg_replace('/\s+/u', ' ', $name) ?? $name;
+        return $name;
+    }
+}
+
+if (!function_exists('is_valid_display_name')) {
+    /**
+     * Allowed: letters/numbers/spaces and . _ - '
+     */
+    function is_valid_display_name(string $name, int $min = 2, int $max = 50): bool {
+        $name = normalize_display_name($name);
+        $len = mb_strlen($name, 'UTF-8');
+        if ($len < $min || $len > $max) return false;
+        return (bool)preg_match("/^[\\p{L}\\p{N} ._\\-']+$/u", $name);
+    }
+}
+
+if (!function_exists('sanitize_display_name')) {
+    /**
+     * Sanitize to allowed character set; returns normalized output.
+     */
+    function sanitize_display_name(string $name, int $min = 2, int $max = 50): string {
+        $name = normalize_display_name($name);
+        $name = preg_replace("/[^\\p{L}\\p{N} ._\\-']+/u", '', $name) ?? $name;
+        $name = normalize_display_name($name);
+        if (mb_strlen($name, 'UTF-8') > $max) {
+            $name = mb_substr($name, 0, $max, 'UTF-8');
+            $name = rtrim($name);
+        }
+        if (mb_strlen($name, 'UTF-8') < $min) return '';
+        return $name;
+    }
+}
 /* =========================
    PDO driver check (mysql / pgsql)
    ========================= */
diff --git a/oauth/facebook/callback/facebook_callback.php b/oauth/facebook/callback/facebook_callback.php
index 4d84d4f..ec2be41 100644
--- a/oauth/facebook/callback/facebook_callback.php
+++ b/oauth/facebook/callback/facebook_callback.php
@@ -110,6 +110,10 @@ if (isset($u['picture']['data']['url'])) {
 
 if ($displayName === '') {
     $displayName = 'Facebook';
+if (function_exists('sanitize_display_name')) {    $displayName = sanitize_display_name($displayName, 2, 50);    if ($displayName === '') $displayName = 'Facebook';}
+if (function_exists('sanitize_display_name')) {    $displayName = sanitize_display_name($displayName, 2, 50);    if ($displayName === '') $displayName = 'Facebook';}
+if (function_exists('sanitize_display_name')) {    $displayName = sanitize_display_name($displayName, 2, 50);    if ($displayName === '') $displayName = 'Facebook';}
+if (function_exists('sanitize_display_name')) {    $displayName = sanitize_display_name($displayName, 2, 50);    if ($displayName === '') $displayName = 'Facebook';}
 }
 
 if ($facebookId === '') {
diff --git a/oauth/facebook_callback.php b/oauth/facebook_callback.php
index abdc55b..1e06d98 100644
--- a/oauth/facebook_callback.php
+++ b/oauth/facebook_callback.php
@@ -110,6 +110,10 @@ if (isset($u['picture']['data']['url'])) {
 
 if ($displayName === '') {
     $displayName = 'Facebook';
+if (function_exists('sanitize_display_name')) {    $displayName = sanitize_display_name($displayName, 2, 50);    if ($displayName === '') $displayName = 'Facebook';}
+if (function_exists('sanitize_display_name')) {    $displayName = sanitize_display_name($displayName, 2, 50);    if ($displayName === '') $displayName = 'Facebook';}
+if (function_exists('sanitize_display_name')) {    $displayName = sanitize_display_name($displayName, 2, 50);    if ($displayName === '') $displayName = 'Facebook';}
+if (function_exists('sanitize_display_name')) {    $displayName = sanitize_display_name($displayName, 2, 50);    if ($displayName === '') $displayName = 'Facebook';}
 }
 
 if ($facebookId === '') {
diff --git a/oauth/github_callback.php b/oauth/github_callback.php
index 11e6bcc..26cdac4 100644
--- a/oauth/github_callback.php
+++ b/oauth/github_callback.php
@@ -124,6 +124,7 @@ $username = trim((string)($u['login'] ?? ''));
 $displayName = trim((string)($u['name'] ?? ''));
 $avatarUrl = trim((string)($u['avatar_url'] ?? ''));
 if ($displayName === '') $displayName = ($username !== '' ? $username : 'GitHub');
+if (function_exists('sanitize_display_name')) {    $displayName = sanitize_display_name($displayName, 2, 50);    if ($displayName === '') $displayName = ($username !== '' ? $username : 'GitHub');}
 
 if ($email === '' || $username === '' || $githubId === '') {
     gdy_oauth_fail('بيانات GitHub غير مكتملة (email/login/id).');
diff --git a/profile.php b/profile.php
index d09a222..e37a18a 100644
--- a/profile.php
+++ b/profile.php
@@ -399,7 +399,7 @@ if ($_SERVER['REQUEST_METHOD'] === 'POST') {
 
             // ===== تحديث بيانات الملف الشخصي =====
             elseif ($action === 'update_profile') {
-                $displayName = trim((string)($_POST['display_name'] ?? ''));
+                $displayName = normalize_display_name((string)($_POST['display_name'] ?? ''));
 
                 $phone   = trim((string)($_POST['phone'] ?? ''));
                 $address = trim((string)($_POST['address'] ?? ''));
@@ -436,9 +436,7 @@ if ($_SERVER['REQUEST_METHOD'] === 'POST') {
                     if (mb_strlen($displayName, 'UTF-8') < 2 || mb_strlen($displayName, 'UTF-8') > 50) {
                         throw new RuntimeException('اسم الظهور يجب أن يكون بين 2 و 50 حرف.');
                     }
-                    // نسمح بالحروف (بما فيها العربية) + الأرقام + العلامات (مثل التشكيل) + بعض الرموز الشائعة.
-                    // الهدف: تجنب XSS مع عدم كسر أسماء عربية تحتوي على تشكيل أو فاصلة عليا.
-                    if (!preg_match('/^[\p{L}\p{M}\p{N}._\-\'’]+(?:\s+[\p{L}\p{M}\p{N}._\-\'’]+)*$/u', $displayName)) {
+                    if (!is_valid_display_name($displayName, 2, 50)) {
                         throw new RuntimeException('اسم الظهور يحتوي على رموز غير مسموحة. المسموح: حروف/أرقام/مسافات و . _ - \'');
                     }
                 }
diff --git a/register.php b/register.php
index 6870b20..dcc1b3e 100644
--- a/register.php
+++ b/register.php
@@ -182,6 +182,7 @@ if ($_SERVER['REQUEST_METHOD'] === 'POST') {
 
                         // display_name (اسم الظهور) افتراضيًا = username أو الجزء قبل @ من البريد
                         $displayName = $username !== '' ? $username : (string)preg_replace('/@.*/', '', $email);
+if (function_exists('sanitize_display_name')) {                            $displayName = sanitize_display_name($displayName, 2, 50);                        }                        if ($displayName === '') $displayName = ($username !== '' ? $username : 'User');
                         // بناء INSERT ديناميكياً حسب الأعمدة المتاحة
                         $insertCols = [];
                         $insertVals = [];
