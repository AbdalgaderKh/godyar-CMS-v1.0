version = 1

# ======================
# المحللون الرئيسيون
# ======================

[[analyzers]]
name = "php"
enabled = true

[[analyzers]]
name = "docker"
enabled = true

# ======================
# إعدادات PHP المتقدمة
# ======================

[analyzers.php]
# إصدار PHP المطلوب
php_version = "8.1"

# تمكين جميع أنماط الفحص
enabled_patterns = [
  # الأمان
  "php/security/*",
  
  # أفضل الممارسات
  "php/best-practice/*",
  
  # جودة الكود
  "php/code-quality/*",
  
  # الأداء
  "php/performance/*",
  
  # قابلية الصيانة
  "php/maintainability/*",
  
  # التوثيق
  "php/documentation/*",
  
  # اكتشاف الأخطاء
  "php/bug-risk/*"
]

# استبعاد قواعد محددة إذا أردت
disabled_patterns = [
  "php/code-style/line-length",  # تجاهل طول السطر
  "php/code-style/function-call-spacing"  # تجاهل المسافات
]

# ======================
# استبعاد الملفات والمجلدات
# ======================

[analyzers.php.meta]
exclude_patterns = [
  "vendor/**/*",           # مكتبات الطرف الثالث
  "node_modules/**/*",     # حزم Node.js
  "storage/**/*",          # ملفات التخزين
  "bootstrap/cache/**/*",  # كاش Laravel
  "public/**/*",           # الأصول العامة
  "tests/**/*",            # ملفات الاختبار
  "database/migrations/**/*.php",  # مigrations (استبعاد اختياري)
  "*.blade.php"            # أو شمله إذا أردت فحص Blade
]

# ======================
# إعدادات Docker
# ======================

[analyzers.docker]
enabled_patterns = [
  "docker/best-practice/*",
  "docker/security/*",
  "docker/bug-risk/*"
]

# ======================
# إعدادات التحليل الإضافية
# ======================

# فحص تبعيات Composer
[[analyzers]]
name = "composer"
enabled = true

# فحص ملفات التهيئة
[[analyzers]]
name = "yaml"
enabled = true

[[analyzers]]
name = "json"
enabled = true

# ======================
# الإعدادات العامة
# ======================

# تخصيص المسارات
[python]
path = "."

# عدد مرات الفحص
test_patterns = ["*_test.py", "test_*.py"]

# تجاهل المسارات
exclude_patterns = ["vendor", "node_modules"]

# ======================
# إعدادات التقارير والإشعارات
# ======================

[report]
# مستوى التفصيل
detail = "high"

# تصنيف المشكلات
issue_labels = {
  "security": ["security", "critical"],
  "performance": ["performance", "high"],
  "bug": ["bug", "medium"],
  "style": ["style", "low"]
}

# الحد الأدنى للخطورة للإبلاغ
severity_threshold = "low"

# ======================
# إعدادات المهام التلقائية
# ======================

[autofix]
# التصحيح التلقائي للمشكلات البسيطة
enabled = true

# أنواع المشكلات القابلة للتصحيح التلقائي
fixable_patterns = [
  "php/code-style/*",
  "php/best-practice/simplify-boolean-return"
]

# ======================
# إعدادات Git
# ======================

[track]
# تتبع التغييرات في أنواع الملفات
file_types = [".php", ".js", ".vue", ".blade.php"]

# تحليل Commits الجديدة فقط
base_branch = "main"

# ======================
# القواعد المخصصة (Custom Rules)
# ======================

[custom_rules]
# قاعدة مخصصة للتحقق من استخدام env() بشكل صحيح
[[custom_rules.php]]
id = "laravel.env-usage"
pattern = "env\\(['\"]([^'\"]+)['\"]\\)"
message = "استخدام env() خارج ملفات التهيئة قد يسبب مشاكل في الكاش"
severity = "medium"

# قاعدة للتحقق من استخدام dd() في production
[[custom_rules.php]]
id = "laravel.dd-usage"
pattern = "\\bdd\\(|\\bdump\\("
message = "تجنب استخدام dd() أو dump() في الكود الرئيسي"
severity = "high"

# ======================
# إعدادات GitHub Integration
# ======================

[github]
# إنشاء تعليقات تلقائية على Pull Requests
pull_request_comments = true

# فحص الملفات المعدلة فقط في PR
diff_analysis = true

# وضع علامات على المشكلات الحرجة
critical_issue_labels = ["security", "critical-bug"]

# ======================
# إعدادات الأداء
# ======================

[performance]
# الحد الأقصى لوقت التحليل (بالثواني)
timeout = 300

# الحد الأقصى لاستخدام الذاكرة (بالميغابايت)
memory_limit = 4096

# تحليل متوازي
parallel_analysis = true

# ======================
# إعدادات التقارير
# ======================

[output]
# أنواع التقارير
formats = ["json", "html", "github"]

# مسار حفظ التقارير
directory = "./reports"

# إرسال التقارير عبر البريد
email_report = false

# ======================
# إعدادات الجدولة
# ======================

[schedule]
# وقت التحليل التلقائي
cron = "0 2 * * *"  # الساعة 2 صباحاً يومياً

# فحص على كل push
on_push = true

# فحص Pull Requests
on_pr = true
